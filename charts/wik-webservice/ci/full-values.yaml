general:
  sealedSecrets: false

webservice:
  image: nginxinc/nginx-unprivileged:latest
  imagePullPolicy: Always
  replicas: 2
  port: 8080
  hosts:
    - test.example.com
    - api.example.com

  service:
    enabled: true
    port: 80
    annotations:
      service.beta.kubernetes.io/aws-load-balancer-type: nlb

  metrics:
    enabled: true
    port: 9090
    path: /metrics

  ingress:
    enabled: true
    className: nginx
    tlsAcme: true
    annotations:
      nginx.ingress.kubernetes.io/proxy-body-size: 200m

  additionalLabels:
    app.kubernetes.io/component: frontend

  annotations:
    co.elastic.logs/enabled: "true"

  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"

  securityContext:
    runAsUser: 1000
    runAsGroup: 1000
    fsGroup: 1000

  containerSecurityContext:
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: true

  livenessProbe:
    httpGet:
      path: /
      port: 8080
    initialDelaySeconds: 30
    periodSeconds: 10

  readinessProbe:
    httpGet:
      path: /
      port: 8080
    initialDelaySeconds: 5
    periodSeconds: 5

  env:
    plaintext:
      ENV_VAR: value
    secret:
      SECRET_VAR: value

  nodeSelector:
    kubernetes.io/os: linux

  affinity:
    nodeAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 1
          preference:
            matchExpressions:
              - key: topology.kubernetes.io/zone
                operator: In
                values:
                  - eu-west-1a

  volumes:
    - name: data
      mountPath: /app/data
      storage:
        accessModes:
          - ReadWriteOnce
        resources:
          requests:
            storage: 10Gi
        storageClassName: standard

    # nginx needs writable dirs when using readOnlyRootFilesystem
    - name: nginx-cache
      mountPath: /var/cache/nginx
      emptyDir: {}
    - name: nginx-run
      mountPath: /var/run
      emptyDir: {}
    - name: nginx-tmp
      mountPath: /tmp
      emptyDir: {}
